package com.github.panarik.javaLesson.work.leetcode;

/**
 * Given a string s, return true if the s can be palindrome after deleting at most one character from it.
 */
public class ValidPalindromeII {

    public static void main(String[] args) {

        String longest = "xzcirfvrxfxhffyyoqfzmwlhtocpkorecuxxbxfbailpjtnuvdiafgxmjymfhhrzmjjpbqjiwunapllxuyurpoiacgtqkizzghmcprpnwembbdbfdtauszgxqaikasibyyuzqrnnjcnkwvclliefsfcbdqxgqddlycrjvtaizjplsbnudpywevxopvqteufkmwdbwgbbknoveuahmwixjhmhaqegibqgnxzavxprllscuzvmrkyvtxxfsvzidkqgcfesotjczqeoxvqdiobkgeotkluutrztaxymfjwueltvpwxwlklxcanzbsyylzekoffufnicqaijdzxelvtaxcgaefssbjmnflgtrusofqzrviwperiavmqccgpzdlfgynfbcyqzdhvxtjywqvqbyrlpptjuxmphpfguvjmtlbbclmqoldbfvaagcevbvwhrjxnjhpoxgvvntdlpjmhpbalqwatchlawqrcxqqeniidjltghiuzegmzwqqdnzpidlbbpoytvnbcugncbmtwwxqrcrcdapkkzulpconbgygqahylyhlqkayzmxvhbhddmylzajihkbtepgirkwaksdgielqxqzunkqdpjhcxuxwbbawgzjirfcigxhqukbofiwuglweahiegbtrpakovnmfuonazudurdgifpeoungmjtzzzgljjwbqwtfelsovaionwzopmqqxepiyzpbbgdimenrvpcbzmomlcrokpndgekvpmghvbqbvkwfvvwfxrecvqysnsasylktswzzfzpbxeokzatqcqqzvodvhamfyvxmmqayzzivjoolikoaewuxbnpohyvnzwevrqwxcljacochkvpbgzfmbuhrwhgdtielsjkfrigaacwsehtldprllzbwirxqtafdmmhuqafxrtyrshwzlntcdquapusecitnglbteduxzrdqfnbciufgkgujggbrqboywuntsmhhkfowkhuewibxakmhrpiiawijohuubyrijsywputwjmjetkqtxmkjxmyriipfixfbajareynwzonfspzhezdqsvzdnonedoreamkdbssglzhkazwdpfpcrjrdfwidnejpiqqltisysijgtynfnmvvgbwmjorptdueslupsklohspyxwparnayfxowdvwyjmshqesmvoyzumbarrjczbnqzaodzyttlhmjpnosndzqlsabnoqeztlppuzukzwuvdeiufshoizglvvxcrdncesdcjzdakwdyaighcoksdjnxmyjoplpbsjinohbxneqrqolruacwgjcvwvpevavjjfzlppsxjtawlhjlddmfrthihgcchnojqwwtzpsdgyacgjgkqxmyypmexdpyoplhskibznbrdgliyzwymteawmmpmhrdbuclyphheqviahocltpxzpnpesqrrtcwhzmcoohbdyeaipnrmqerpxyfiqxulgbxqsomwgyfjimgpypqlgfvlsltmydnhwulasrtcbxpzoiioqoioslwghjxhhqjpdlcvytyedgdqietqikczwayomtlsunliqhyzfchggpcvgiofpoaaxjiubknbmtvwnlgmtpbtmjndzgnxjdzqjobcruzcowlwctdwbsfotpaiwtdxsyxnubgwfibtodiqaefmayufxjxfstgaluvoagalwtskiofobzqfonxenotktrardbqpgwzumicbtxiiqmihnrgwmfdtzvabonirdtezdwuohazkwymhdrmcwujovevdkhkifualyiserniacnukwmnwpzzgqqmxjqkgxeawcwpbrctazshpmukouwurcqxofvueoiuvcfwerqethqknatyabgdjsdathttvutjcqizjixbrsdkkaaskpkvciqxwxreocskkgafevvoxriagintycemzbgffiycjslgfsozharaurajwqpmvufvoohpckxnhtzhessjumdodgfblkarwizbaphrahkioufwwddalnishiosjnpnhrxaxttaekwgepfsqwqhqbhiwezutuvqjsooqcihamjnopxewlljuxoqxnfusqmlmlioxeqczakfxsgoawheirdxtzllhznxcweljuxrirmtqtnpinzfkumgdrjmxvumgosphzoddmmcrjplnmeenrnyfokugtjtbotibhhfjggzqfrewzmdmylliwauofrcogoblqfnseqjjutpvelepbojfckkfvgnoeohmhouejbzlefixcypuradmequntuomrwtxulseqdxpvuxlcmboftumybsfelvyrtewjlhfxhvsdwqiuretzcvgmcjefdpteebsxgkzmnvwxbmtmhqyxefysmhfojltojrxgmvwcwziskfzhahpheyliytlmfdaolwznvbiuhhmontkojraquvefxmcmgnjlaqjrilkljqtlvzzsohghxfwbqkbvxxoluzsuwnhumudlpuueubtljvvjrfarokfqdjtaqbdvcjaoszafywjllkiiahucjajncyqmsgumnbnykxmkdfkwjeydyapviqoaywwzleiekuoalibhkmtrwyuurpvovkycfuoagnhlfdzsnbjxorioswokcudvawhnljujdggbbuelshoglyytuplbikkxhjhyszszacluengrevmrfqxrthcevuavcgrthvfmyzfwithlcpwroyplaxwmtlnqrwwuzwwwjdtorncfqxwgogtoehysxpzuwffarkxmilntpusmkruupyfxeenevtgsqhryrhygnwqzcshpswjycrfqxnxziibxggytocmciksnnvldsgfbqfymjssuyibsrwibmaveowpydeqqoqexmwnhnpnaxsmhlscfzmthlkyeufpwfwwlujxmlwjennuoatdlybzcglpvgxydfyrxjogbidknqewlnpmecrgqifcnfugyctufuvfmunwnqlarcqtiljhzetxflvucdlrdbpihrxpqmwwqpcadpzucndydrostuvvrzzwapvokhwogjyrymrpemcdndpajwhylntcuzppsccejsckgocrcwvwxzxzteukzyqwuvswqqnmlgjpegmcwihbplnnkebebjrzhqozwwhnuadesgkshwmaggcrmuqeqgtelokkzbkiwtxjqwytgdxflolrvdkcxnumociqfudlitefqrhwwvbgvviuspyfucjuysctpuwlngocsakpcwamkuobbtvjaugogwxzjulxdxtfncvdvleihrawvsqcfbmdtalqdiydhytdwostgbyibrgkxaxfcnnslldqwyuyporzyfguzxwmoavcglkwyikbgdaddzpfdbnxdhpqvpahkeedbclgveoewlurgxselfgqyjrlikunjkgusbnzpfsobandgyepcevlozabgyzcsaqcewsdckqyftocxmzgdihnqoipvkudrrkhudddxmxmkpysovirqpyaalzlrvtynqlbonvethsfratgxtedmsvpvgbktudfzopnyihqbziqonswzhtgzlhzhqtmbvaetwpzphglefvicbtxnljpdemupymvnnybnovkpplqleptrqvfblclqeyvzswdcrexdqaraivnmxvvkwizutxbwvfbgfvafnbiajegtzxllmznnileslvjztgrzjaeiufliwveoklnpgrfspmeazetppddrokllclfeymfzfgsdvzrwosmbhlexkgskboxhtiyujmjqflxeyymusamdcwjtgarkepsdffpotdpeyxcrjiyyvsglubayokgfptxehinnmvqwdbsvlsxnqhaksxsbmqsamllmrczlvzzfytruawqdvudbukqxfremjsxkgqidqcvxhptkeircheuzcdsjjxvdhowjkhjxvxgoefdgiavtvazvwdyfknucmldcmfzhkpwpoozwwwmpbkgvqziaownrmkxaoeqykvysttndmuipppkdynyvjxyaqtbhgssttyhbzhvlmnnlulhjgubnqdknprugufkwuqkoqbtdmbyuazlshyojfukdbyiheuwfesvfuamctfyxfjgxxgqlrrdbsptmyxmtrftbutqmweyzjocxtpznppgzcthwuzwwhmiyrowdmuvitiwzutltjyummqqnurfxvceuqqtnuluqsbmxosultrilfnirknrkufhwhuigtbaycdkuqyxxlfitarnxahqxcdxidgwmscynouhoyztohqyjqcbtkxzrfpjfznkkkvolkxkhyevceiuyodrskbcsoexncqctmcsnfoapmzvcsepxktsiqwuwklvmuknwoifzbcbhfefqkgfctqrtehrzcjhyrsoxexnsmrzeuuantzsfltfyoeaxwbvxqggkxueiykbphjptpxcuihztuvtlmwdzxwkqclulnztsgwxsgaubobsucmtxptyxntmwaptydiaynytlmzeomnlozwqugcurnahrvunogizuojpcarqcwfgqyfphsafgoqxstwmnkdbnqgvifdpvhbcouozmqsfdzlnvevjdhhvuefzaeiuztiwvubiyqyfleyrqcgbgkplszbynbvckipffrrlwnimwfnivuoiilployzfbfoqqwcmvjqzsimoezzdzzevwfmtwkbiwjharyduhgnwmreshbitimmxgjbfaoflqonqwctmcdkmxooudfqrmuibbpzszgxekardzibiebpldxbjyanttdigjfnbxrebncavhziqaidywzbehnkjidoixnpgsavzbtcvicvdybontrezuynwipkhstjljwxezwunvsedoevtvjejwslbqmteaumbimeplkxtnrarwlokkikouaorpmpqxonohubalwmbtmhtbwiuvowtayxyngdiaxnhriqrhxpzkqlhgrzuufsoyvtchjdcmofmkcuxzwnhpuodfeqgzagxwswjvprkeanlenrysuyckggkcyusyrnelnaekrpvjwswxgazgqefdouphnwzxuckmfomcdjhctvyosfuuzrghlqkzpxhrqirhnxaidgnyxyatwovuiwbthmtbmwlabuhonoxqpmproauokikkolwrarntxklpemibmuaetmqblswjejvtveodesvnuwzexwjljtshkpiwnyuzertnobydvcivctbzvasgpnxiodijknhebzwydiaqizhvacnberxbnfjgidttnayjbxdlpbeibizdrakexgzszpbbiumrqfduooxmkdcmtcwqnoqlfoafbjgxmmitibhsermwnghudyrahjwibkwtmfwvezzdzzeomiszqjvmcwqqofbfzyolpliiouvinfwminwlrrffpikcvbnybzslpkgbgcqryelfyqyibuvwitzuieazfeuvhhdjvevnlzdfsqmzouocbhvpdfivgqnbdknmwtsxqogfashpfyqgfwcqracpjouzigonuvrhanrucguqwzolnmoezmltynyaidytpawmtnxytpxtmcusbobuagsxwgstznlulcqkwxzdwmltvutzhiucxptpjhpbkyieuxkggqxvbwxaeoyftlfsztnauuezrmsnxexosryhjczrhetrqtcfgkqfefhbcbzfiownkumvlkwuwqistkxpescvzmpaofnscmtcqcnxeoscbksrdoyuiecveyhkxklovkkknzfjpfrzxktbcqjyqhotzyohuonycsmwgdixdcxqhaxnratiflxxyqukdcyabtgiuhwhfukrnkrinflirtlusoxmbsquluntqquecvxfrunqqmmuyjtltuzwitivumdworyimhwwzuwhtczgppnzptxcojzyewmqtubtfrtmxymtpsbdrrlqgxxgjfxyftcmaufvsefwuehiybdkufjoyhslzauybmdtbqokquwkfugurpnkdqnbugjhlulnnmlvhzbhyttssghbtqayxjvynydkpppiumdnttsyvkyqeoaxkmrnwoaizqvgkbpmwwwzoopwpkhzfmcdlmcunkfydwvzavtvaigdfeogxvxjhkjwohdvxjjsdczuehcriektphxvcqdiqgkxsjmerfxqkubduvdqwaurtyfzzvlzcrmllmasqmbsxskahqnxslvsbdwqvmnnihextpfgkoyabulgsvyyijrcxyepdtopffdspekragtjwcdmasumyyexlfqjmjuyithxobksgkxelhbmsowrzvdsgfzfmyeflcllkorddpptezaempsfrgpnlkoevwilfuieajzrgtzjvlselinnzmllxztgejaibnfavfgbfvwbxtuziwkvvxmnviaraqdxercdwszvyeqlclbfvqrtpelqlppkvonbynnvmypumedpjlnxtbcivfelghpzpwteavbmtqhzhlzgthzwsnoqizbqhiynpozfdutkbgvpvsmdetxgtarfshtevnoblqnytvrlzlaaypqrivosypkmxmxddduhkrrdukvpioqnhidgzmxcotfyqkcdswecqasczygbazolvecpeygdnabosfpznbsugkjnukilrjyqgflesxgrulweoevglcbdeekhapvqphdxnbdfpzddadgbkiywklgcvaomwxzugfyzropyuywqdllsnncfxaxkgrbiybgtsowdtyhdyidqlatdmbfcqsvwarhielvdvcnftxdxlujzxwgoguajvtbboukmawcpkascognlwuptcsyujcufypsuivvgbvwwhrqfetildufqicomunxckdvrlolfxdgtywqjxtwikbzkkoletgqequmrcggamwhskgsedaunhwwzoqhzrjbebeknnlpbhiwcmgepjglmnqqwsvuwqyzkuetzxzxwvwcrcogkcsjeccsppzuctnlyhwjapdndcmeprmyryjgowhkovpawzzrvvutsordydncuzpdacpqwwmqpxrhipbdrldcuvlfxtezhjlitqcralqnwnumfvufutcygufncfiqgrcempnlweqnkdibgojxryfdyxgvplgczbyldtaounnejwlmxjulwwfwpfueyklhtmzfcslhmsxanpnhnwmxeqoqqedypwoevambiwrsbiyussjmyfqbfgsdlvnnskicmcotyggxbiizxnxqfrcyjwsphsczqwngyhryrhqsgtveneexfypuurkmsuptnlimxkraffwuzpxsyheotgogwxqfcnrotdjwwwzuwwrqnltmwxalpyorwpclhtiwfzymfvhtrgcvauvechtrxqfrmvergneulcazszsyhjhxkkiblputyylgohsleubbggdjujlnhwavduckowsoiroxjbnszdflhngaoufcykvovpruuywrtmkhbilaoukeielzwwyaoqivpaydyejwkfdkmxkynbnmugsmqycnjajcuhaiiklljwyfazsoajcvdbqatjdqfkorafrjvvjltbueuupldumuhnwuszuloxxvbkqbwfxhghoszzvltqjlklirjqaljngmcmxfevuqarjoktnomhhuibvnzwloadfmltyilyehphahzfksizwcwvmgxrjotljofhmsyfexyqhmtmbxwvnmzkgxsbeetpdfejcmgvczteruiqwdsvhxfhljwetryvlefsbymutfobmclxuvpxdqesluxtwrmoutnuqemdarupycxifelzbjeuohmhoeongvfkkcfjobpelevptujjqesnfqlbogocrfouawillymdmzwerfqzggjfhhbitobtjtgukofynrneemnlpjrcmmddozhpsogmuvxmjrdgmukfznipntqtmrirxujlewcxnzhllztxdriehwaogsxfkazcqexoilmlmqsufnxqoxujllwexponjmahicqoosjqvutuzewihbqhqwqsfpegwkeattxaxrhnpnjsoihsinladdwwfuoikharhpabziwraklbfgdodmujssehzthnxkcphoovfuvmpqwjaruarahzosfglsjcyiffgbzmecytnigairxovvefagkkscoerxwxqicvkpksaakkdsrbxijziqcjtuvtthtadsjdgbaytankqhteqrewfcvuioeuvfoxqcruwuokumphszatcrbpwcwaexgkqjxmqqgzzpwnmwkuncainresiylaufikhkdvevojuwcmrdhmywkzahouwdzetdrinobavztdfmwgrnhimqiixtbcimuzwgpqbdrartktonexnofqzbofoikstwlagaovulagtsfxjxfuyamfeaqidotbifwgbunxysxdtwiaptofsbwdtcwlwoczurcbojqzdjxngzdnjmtbptmglnwvtmbnkbuijxaaopfoigvcpgghcfzyhqilnusltmoyawzckiqteiqdgdeytyvcldpjqhhxjhgwlsoioqoiiozpxbctrsaluwhndymtlslvfglqpypmijfygwmosqxbgluxqifyxpreqmrnpiaeydbhoocmzhwctrrqsepnpzxptlcohaivqehhpylcubdrhmpmmwaetmywzyilgdrbnzbikshlpoypdxempyymxqkgjgcaygdspztwwqjonhccghihtrfmddljhlwatjxspplzfjjvavepvwvcjgwcaurloqrqenxbhonijsbplpojymxnjdskochgiaydwkadzjcdsecndrcxvvlgziohsfuiedvuwzkuzuppltzeqonbaslqzdnsonpjmhlttyzdoazqnbzcjrrabmuzyovmseqhsmjywvdwoxfyanrapwxypsholkspulseudtprojmwbgvvmnfnytgjisysitlqqipjendiwfdrjrcpfpdwzakhzlgssbdkmaerodenondzvsqdzehzpsfnozwnyerajabfxifpiirymxjkmxtqktejmjwtupwysjirybuuhojiwaiiprhmkaxbiweuhkwofkhhmstnuwyobqrbggjugkgfuicbnfqdrzxudetblgnticesupauqdctnlzwhsrytrxfaquhmmdfatqxriwbzllrpdltheswcaagirfkjsleitdghwrhubmfzgbpvkhcocajlcxwqrvewznvyhopnbxuweaokiloojvizzyaqmmxvyfmahvdovzqqcqtazkoexbpzfzzwstklysasnsyqvcerxfwvvfwkvbqbvhgmpvkegdnpkorclmomzbcpvrnemidgbbpzyipexqqmpozwnoiavosleftwqbwjjlgzzztjmgnuoepfigdruduzanoufmnvokaprtbgeihaewlguwifobkuqhxgicfrijzgwabbwxuxchjpdqknuzqxqleigdskawkrigpetbkhijazlymddhbhvxmzyakqlhylyhaqgygbnocpluzkkpadcrcrqxwwtmbcngucbnvtyopbbldipzndqqwzmgezuihgtljdiineqqxcrqwalhctawqlabphmjpldtnvvgxophjnxjrhwvbvecgaavfbdloqmlcbbltmjvugfphpmxujtpplrybqvqwyjtxvhdzqycbfnygfldzpgccqmvairepwivrzqfosurtglfnmjbssfeagcxatvlexzdjiaqcinfuffokezlyysbznacxlklwxwpvtleuwjfmyxatzrtuulktoegkboidqvxoeqzcjtosefcgqkdizvsfxxtvykrmvzucsllrpxvazxngqbigeqahmhjxiwmhauevonkbbgwbdwmkfuetqvpoxvewypdunbslpjziatvjrcylddqgxqdbcfsfeillcvwkncjnnrqzuyybisakiaqxgzsuatdfbdbbmewnprpcmhgzzikqtgcaiopruyuxllpanuwijqbpjjmzrhhfmyjmxgfaidvuntjpliabfxbxxucerokpcothlwmzfqoyyffhxfxrvfriczx";

        System.out.println("(fast with 'aba' )  must be true: " + new ValidPalindromeII().validPalindrome("aba"));
        System.out.println("(slow with 'aba' )  must be true: " + new ValidPalindromeII().validPalindromeSlow("aba"));
        System.out.println("(fast with 'tcaac' )  must be true: " + new ValidPalindromeII().validPalindrome("tcaac"));
        System.out.println("(slow with 'tcaac' )  must be true: " + new ValidPalindromeII().validPalindromeSlow("tcaac"));
        System.out.println("(fast with 'caact' )  must be true: " + new ValidPalindromeII().validPalindrome("caact"));
        System.out.println("(slow with 'caact' )  must be true: " + new ValidPalindromeII().validPalindromeSlow("caact"));
        System.out.println("(fast with 'abca')  must be true: " + new ValidPalindromeII().validPalindrome("abca"));
        System.out.println("(slow with 'abca')  must be true: " + new ValidPalindromeII().validPalindromeSlow("abca"));
        System.out.println("(fast with 'abc' )  must be false: " + new ValidPalindromeII().validPalindrome("abc"));
        System.out.println("(slow with 'abc ')  must be false: " + new ValidPalindromeII().validPalindromeSlow("abc"));
        System.out.println("(fast with 'dedeeee')  must be false: " + new ValidPalindromeII().validPalindrome("dedeeee"));
        System.out.println("(slow with 'dedeeee')  must be false: " + new ValidPalindromeII().validPalindromeSlow("dedeeee"));
        System.out.println("(fast with 'deeee') must be true: " + new ValidPalindromeII().validPalindrome("deeee"));
        System.out.println("(slow with 'deeee') must be true: " + new ValidPalindromeII().validPalindromeSlow("deeee"));
        System.out.println("(fast with 'angna') must be true: " + new ValidPalindromeII().validPalindrome("angna"));
        System.out.println("(slow with 'angna') must be true: " + new ValidPalindromeII().validPalindromeSlow("angna"));
        System.out.println("(fast with 'a')     must be true: " + new ValidPalindromeII().validPalindrome("a"));
        System.out.println("(slow with 'a')     must be true: " + new ValidPalindromeII().validPalindromeSlow("a"));
        System.out.println("(fast with '')      must be true: " + new ValidPalindromeII().validPalindrome(""));
        System.out.println("(slow with '')      must be true: " + new ValidPalindromeII().validPalindromeSlow(""));
        System.out.println("(fast with 'eeccccbebaeeabebccceea')      must be false: " + new ValidPalindromeII().validPalindrome("eeccccbebaeeabebccceea"));
        System.out.println("(slow with 'eeccccbebaeeabebccceea')      must be false: " + new ValidPalindromeII().validPalindromeSlow("eeccccbebaeeabebccceea"));
        System.out.println("(fast with longest) must be true: " + new ValidPalindromeII().validPalindrome(longest));
        System.out.println("(slow with longest) must be true: " + new ValidPalindromeII().validPalindromeSlow(longest));
    }

    public boolean validPalindrome(String s) {
        int firstIndex, lastIndex;
        int anomalyScore = 0; // Palindrome anomaly score.

        // check all string from sides to center
        for (firstIndex = 0, lastIndex = s.length() - 1; firstIndex <= lastIndex; firstIndex++, lastIndex--) {
            char skippedFirst = s.charAt(firstIndex);
            char skippedLast = s.charAt(lastIndex);

            // if anomaly found
            if (skippedFirst != skippedLast) {
                return isPalindrome(s, firstIndex + 1, lastIndex) || isPalindrome(s, firstIndex, lastIndex - 1);
            }

        }

        return true;
    }

    private boolean isPalindrome(String s, int firstIndex, int lastIndex) {
        while (firstIndex <= lastIndex) {
            if (s.charAt(firstIndex) == s.charAt(lastIndex)) {
                firstIndex++;
                lastIndex--;
            } else return false;
        }
        return true;
    }


    public boolean validPalindromeSlow(String s) {

        // First check palindrome.
        StringBuilder builder = new StringBuilder(s);
        if (builder.reverse().toString().equals(s)) return true;

        // Try to delete letters and check possible palindrome.
        for (int i = 0; i < s.length(); i++) {
            char ch = builder.charAt(i);
            builder.deleteCharAt(i); // Delete one char.
            if (new StringBuilder(builder).reverse().toString().equals(builder.toString())) return true; // Check it.
            builder.insert(i, ch); // Return this char back.
        }
        return false;
    }

}
