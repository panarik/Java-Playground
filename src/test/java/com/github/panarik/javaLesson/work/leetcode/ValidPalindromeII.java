package com.github.panarik.javaLesson.work.leetcode;

/**
 * Given a string s, return true if the s can be palindrome after deleting at most one character from it.
 */
public class ValidPalindromeII {

    public static void main(String[] args) {

        String longest = "xzcirfvrxfxhffyyoqfzmwlhtocpkorecuxxbxfbailpjtnuvdiafgxmjymfhhrzmjjpbqjiwunapllxuyurpoiacgtqkizzghmcprpnwembbdbfdtauszgxqaikasibyyuzqrnnjcnkwvclliefsfcbdqxgqddlycrjvtaizjplsbnudpywevxopvqteufkmwdbwgbbknoveuahmwixjhmhaqegibqgnxzavxprllscuzvmrkyvtxxfsvzidkqgcfesotjczqeoxvqdiobkgeotkluutrztaxymfjwueltvpwxwlklxcanzbsyylzekoffufnicqaijdzxelvtaxcgaefssbjmnflgtrusofqzrviwperiavmqccgpzdlfgynfbcyqzdhvxtjywqvqbyrlpptjuxmphpfguvjmtlbbclmqoldbfvaagcevbvwhrjxnjhpoxgvvntdlpjmhpbalqwatchlawqrcxqqeniidjltghiuzegmzwqqdnzpidlbbpoytvnbcugncbmtwwxqrcrcdapkkzulpconbgygqahylyhlqkayzmxvhbhddmylzajihkbtepgirkwaksdgielqxqzunkqdpjhcxuxwbbawgzjirfcigxhqukbofiwuglweahiegbtrpakovnmfuonazudurdgifpeoungmjtzzzgljjwbqwtfelsovaionwzopmqqxepiyzpbbgdimenrvpcbzmomlcrokpndgekvpmghvbqbvkwfvvwfxrecvqysnsasylktswzzfzpbxeokzatqcqqzvodvhamfyvxmmqayzzivjoolikoaewuxbnpohyvnzwevrqwxcljacochkvpbgzfmbuhrwhgdtielsjkfrigaacwsehtldprllzbwirxqtafdmmhuqafxrtyrshwzlntcdquapusecitnglbteduxzrdqfnbciufgkgujggbrqboywuntsmhhkfowkhuewibxakmhrpiiawijohuubyrijsywputwjmjetkqtxmkjxmyriipfixfbajareynwzonfspzhezdqsvzdnonedoreamkdbssglzhkazwdpfpcrjrdfwidnejpiqqltisysijgtynfnmvvgbwmjorptdueslupsklohspyxwparnayfxowdvwyjmshqesmvoyzumbarrjczbnqzaodzyttlhmjpnosndzqlsabnoqeztlppuzukzwuvdeiufshoizglvvxcrdncesdcjzdakwdyaighcoksdjnxmyjoplpbsjinohbxneqrqolruacwgjcvwvpevavjjfzlppsxjtawlhjlddmfrthihgcchnojqwwtzpsdgyacgjgkqxmyypmexdpyoplhskibznbrdgliyzwymteawmmpmhrdbuclyphheqviahocltpxzpnpesqrrtcwhzmcoohbdyeaipnrmqerpxyfiqxulgbxqsomwgyfjimgpypqlgfvlsltmydnhwulasrtcbxpzoiioqoioslwghjxhhqjpdlcvytyedgdqietqikczwayomtlsunliqhyzfchggpcvgiofpoaaxjiubknbmtvwnlgmtpbtmjndzgnxjdzqjobcruzcowlwctdwbsfotpaiwtdxsyxnubgwfibtodiqaefmayufxjxfstgaluvoagalwtskiofobzqfonxenotktrardbqpgwzumicbtxiiqmihnrgwmfdtzvabonirdtezdwuohazkwymhdrmcwujovevdkhkifualyiserniacnukwmnwpzzgqqmxjqkgxeawcwpbrctazshpmukouwurcqxofvueoiuvcfwerqethqknatyabgdjsdathttvutjcqizjixbrsdkkaaskpkvciqxwxreocskkgafevvoxriagintycemzbgffiycjslgfsozharaurajwqpmvufvoohpckxnhtzhessjumdodgfblkarwizbaphrahkioufwwddalnishiosjnpnhrxaxttaekwgepfsqwqhqbhiwezutuvqjsooqcihamjnopxewlljuxoqxnfusqmlmlioxeqczakfxsgoawheirdxtzllhznxcweljuxrirmtqtnpinzfkumgdrjmxvumgosphzoddmmcrjplnmeenrnyfokugtjtbotibhhfjggzqfrewzmdmylliwauofrcogoblqfnseqjjutpvelepbojfckkfvgnoeohmhouejbzlefixcypuradmequntuomrwtxulseqdxpvuxlcmboftumybsfelvyrtewjlhfxhvsdwqiuretzcvgmcjefdpteebsxgkzmnvwxbmtmhqyxefysmhfojltojrxgmvwcwziskfzhahpheyliytlmfdaolwznvbiuhhmontkojraquvefxmcmgnjlaqjrilkljqtlvzzsohghxfwbqkbvxxoluzsuwnhumudlpuueubtljvvjrfarokfqdjtaqbdvcjaoszafywjllkiiahucjajncyqmsgumnbnykxmkdfkwjeydyapviqoaywwzleiekuoalibhkmtrwyuurpvovkycfuoagnhlfdzsnbjxorioswokcudvawhnljujdggbbuelshoglyytuplbikkxhjhyszszacluengrevmrfqxrthcevuavcgrthvfmyzfwithlcpwroyplaxwmtlnqrwwuzwwwjdtorncfqxwgogtoehysxpzuwffarkxmilntpusmkruupyfxeenevtgsqhryrhygnwqzcshpswjycrfqxnxziibxggytocmciksnnvldsgfbqfymjssuyibsrwibmaveowpydeqqoqexmwnhnpnaxsmhlscfzmthlkyeufpwfwwlujxmlwjennuoatdlybzcglpvgxydfyrxjogbidknqewlnpmecrgqifcnfugyctufuvfmunwnqlarcqtiljhzetxflvucdlrdbpihrxpqmwwqpcadpzucndydrostuvvrzzwapvokhwogjyrymrpemcdndpajwhylntcuzppsccejsckgocrcwvwxzxzteukzyqwuvswqqnmlgjpegmcwihbplnnkebebjrzhqozwwhnuadesgkshwmaggcrmuqeqgtelokkzbkiwtxjqwytgdxflolrvdkcxnumociqfudlitefqrhwwvbgvviuspyfucjuysctpuwlngocsakpcwamkuobbtvjaugogwxzjulxdxtfncvdvleihrawvsqcfbmdtalqdiydhytdwostgbyibrgkxaxfcnnslldqwyuyporzyfguzxwmoavcglkwyikbgdaddzpfdbnxdhpqvpahkeedbclgveoewlurgxselfgqyjrlikunjkgusbnzpfsobandgyepcevlozabgyzcsaqcewsdckqyftocxmzgdihnqoipvkudrrkhudddxmxmkpysovirqpyaalzlrvtynqlbonvethsfratgxtedmsvpvgbktudfzopnyihqbziqonswzhtgzlhzhqtmbvaetwpzphglefvicbtxnljpdemupymvnnybnovkpplqleptrqvfblclqeyvzswdcrexdqaraivnmxvvkwizutxbwvfbgfvafnbiajegtzxllmznnileslvjztgrzjaeiufliwveoklnpgrfspmeazetppddrokllclfeymfzfgsdvzrwosmbhlexkgskboxhtiyujmjqflxeyymusamdcwjtgarkepsdffpotdpeyxcrjiyyvsglubayokgfptxehinnmvqwdbsvlsxnqhaksxsbmqsamllmrczlvzzfytruawqdvudbukqxfremjsxkgqidqcvxhptkeircheuzcdsjjxvdhowjkhjxvxgoefdgiavtvazvwdyfknucmldcmfzhkpwpoozwwwmpbkgvqziaownrmkxaoeqykvysttndmuipppkdynyvjxyaqtbhgssttyhbzhvlmnnlulhjgubnqdknprugufkwuqkoqbtdmbyuazlshyojfukdbyiheuwfesvfuamctfyxfjgxxgqlrrdbsptmyxmtrftbutqmweyzjocxtpznppgzcthwuzwwhmiyrowdmuvitiwzutltjyummqqnurfxvceuqqtnuluqsbmxosultrilfnirknrkufhwhuigtbaycdkuqyxxlfitarnxahqxcdxidgwmscynouhoyztohqyjqcbtkxzrfpjfznkkkvolkxkhyevceiuyodrskbcsoexncqctmcsnfoapmzvcsepxktsiqwuwklvmuknwoifzbcbhfefqkgfctqrtehrzcjhyrsoxexnsmrzeuuantzsfltfyoeaxwbvxqggkxueiykbphjptpxcuihztuvtlmwdzxwkqclulnztsgwxsgaubobsucmtxptyxntmwaptydiaynytlmzeomnlozwqugcurnahrvunogizuojpcarqcwfgqyfphsafgoqxstwmnkdbnqgvifdpvhbcouozmqsfdzlnvevjdhhvuefzaeiuztiwvubiyqyfleyrqcgbgkplszbynbvckipffrrlwnimwfnivuoiilployzfbfoqqwcmvjqzsimoezzdzzevwfmtwkbiwjharyduhgnwmreshbitimmxgjbfaoflqonqwctmcdkmxooudfqrmuibbpzszgxekardzibiebpldxbjyanttdigjfnbxrebncavhziqaidywzbehnkjidoixnpgsavzbtcvicvdybontrezuynwipkhstjljwxezwunvsedoevtvjejwslbqmteaumbimeplkxtnrarwlokkikouaorpmpqxonohubalwmbtmhtbwiuvowtayxyngdiaxnhriqrhxpzkqlhgrzuufsoyvtchjdcmofmkcuxzwnhpuodfeqgzagxwswjvprkeanlenrysuyckggkcyusyrnelnaekrpvjwswxgazgqefdouphnwzxuckmfomcdjhctvyosfuuzrghlqkzpxhrqirhnxaidgnyxyatwovuiwbthmtbmwlabuhonoxqpmproauokikkolwrarntxklpemibmuaetmqblswjejvtveodesvnuwzexwjljtshkpiwnyuzertnobydvcivctbzvasgpnxiodijknhebzwydiaqizhvacnberxbnfjgidttnayjbxdlpbeibizdrakexgzszpbbiumrqfduooxmkdcmtcwqnoqlfoafbjgxmmitibhsermwnghudyrahjwibkwtmfwvezzdzzeomiszqjvmcwqqofbfzyolpliiouvinfwminwlrrffpikcvbnybzslpkgbgcqryelfyqyibuvwitzuieazfeuvhhdjvevnlzdfsqmzouocbhvpdfivgqnbdknmwtsxqogfashpfyqgfwcqracpjouzigonuvrhanrucguqwzolnmoezmltynyaidytpawmtnxytpxtmcusbobuagsxwgstznlulcqkwxzdwmltvutzhiucxptpjhpbkyieuxkggqxvbwxaeoyftlfsztnauuezrmsnxexosryhjczrhetrqtcfgkqfefhbcbzfiownkumvlkwuwqistkxpescvzmpaofnscmtcqcnxeoscbksrdoyuiecveyhkxklovkkknzfjpfrzxktbcqjyqhotzyohuonycsmwgdixdcxqhaxnratiflxxyqukdcyabtgiuhwhfukrnkrinflirtlusoxmbsquluntqquecvxfrunqqmmuyjtltuzwitivumdworyimhwwzuwhtczgppnzptxcojzyewmqtubtfrtmxymtpsbdrrlqgxxgjfxyftcmaufvsefwuehiybdkufjoyhslzauybmdtbqokquwkfugurpnkdqnbugjhlulnnmlvhzbhyttssghbtqayxjvynydkpppiumdnttsyvkyqeoaxkmrnwoaizqvgkbpmwwwzoopwpkhzfmcdlmcunkfydwvzavtvaigdfeogxvxjhkjwohdvxjjsdczuehcriektphxvcqdiqgkxsjmerfxqkubduvdqwaurtyfzzvlzcrmllmasqmbsxskahqnxslvsbdwqvmnnihextpfgkoyabulgsvyyijrcxyepdtopffdspekragtjwcdmasumyyexlfqjmjuyithxobksgkxelhbmsowrzvdsgfzfmyeflcllkorddpptezaempsfrgpnlkoevwilfuieajzrgtzjvlselinnzmllxztgejaibnfavfgbfvwbxtuziwkvvxmnviaraqdxercdwszvyeqlclbfvqrtpelqlppkvonbynnvmypumedpjlnxtbcivfelghpzpwteavbmtqhzhlzgthzwsnoqizbqhiynpozfdutkbgvpvsmdetxgtarfshtevnoblqnytvrlzlaaypqrivosypkmxmxddduhkrrdukvpioqnhidgzmxcotfyqkcdswecqasczygbazolvecpeygdnabosfpznbsugkjnukilrjyqgflesxgrulweoevglcbdeekhapvqphdxnbdfpzddadgbkiywklgcvaomwxzugfyzropyuywqdllsnncfxaxkgrbiybgtsowdtyhdyidqlatdmbfcqsvwarhielvdvcnftxdxlujzxwgoguajvtbboukmawcpkascognlwuptcsyujcufypsuivvgbvwwhrqfetildufqicomunxckdvrlolfxdgtywqjxtwikbzkkoletgqequmrcggamwhskgsedaunhwwzoqhzrjbebeknnlpbhiwcmgepjglmnqqwsvuwqyzkuetzxzxwvwcrcogkcsjeccsppzuctnlyhwjapdndcmeprmyryjgowhkovpawzzrvvutsordydncuzpdacpqwwmqpxrhipbdrldcuvlfxtezhjlitqcralqnwnumfvufutcygufncfiqgrcempnlweqnkdibgojxryfdyxgvplgczbyldtaounnejwlmxjulwwfwpfueyklhtmzfcslhmsxanpnhnwmxeqoqqedypwoevambiwrsbiyussjmyfqbfgsdlvnnskicmcotyggxbiizxnxqfrcyjwsphsczqwngyhryrhqsgtveneexfypuurkmsuptnlimxkraffwuzpxsyheotgogwxqfcnrotdjwwwzuwwrqnltmwxalpyorwpclhtiwfzymfvhtrgcvauvechtrxqfrmvergneulcazszsyhjhxkkiblputyylgohsleubbggdjujlnhwavduckowsoiroxjbnszdflhngaoufcykvovpruuywrtmkhbilaoukeielzwwyaoqivpaydyejwkfdkmxkynbnmugsmqycnjajcuhaiiklljwyfazsoajcvdbqatjdqfkorafrjvvjltbueuupldumuhnwuszuloxxvbkqbwfxhghoszzvltqjlklirjqaljngmcmxfevuqarjoktnomhhuibvnzwloadfmltyilyehphahzfksizwcwvmgxrjotljofhmsyfexyqhmtmbxwvnmzkgxsbeetpdfejcmgvczteruiqwdsvhxfhljwetryvlefsbymutfobmclxuvpxdqesluxtwrmoutnuqemdarupycxifelzbjeuohmhoeongvfkkcfjobpelevptujjqesnfqlbogocrfouawillymdmzwerfqzggjfhhbitobtjtgukofynrneemnlpjrcmmddozhpsogmuvxmjrdgmukfznipntqtmrirxujlewcxnzhllztxdriehwaogsxfkazcqexoilmlmqsufnxqoxujllwexponjmahicqoosjqvutuzewihbqhqwqsfpegwkeattxaxrhnpnjsoihsinladdwwfuoikharhpabziwraklbfgdodmujssehzthnxkcphoovfuvmpqwjaruarahzosfglsjcyiffgbzmecytnigairxovvefagkkscoerxwxqicvkpksaakkdsrbxijziqcjtuvtthtadsjdgbaytankqhteqrewfcvuioeuvfoxqcruwuokumphszatcrbpwcwaexgkqjxmqqgzzpwnmwkuncainresiylaufikhkdvevojuwcmrdhmywkzahouwdzetdrinobavztdfmwgrnhimqiixtbcimuzwgpqbdrartktonexnofqzbofoikstwlagaovulagtsfxjxfuyamfeaqidotbifwgbunxysxdtwiaptofsbwdtcwlwoczurcbojqzdjxngzdnjmtbptmglnwvtmbnkbuijxaaopfoigvcpgghcfzyhqilnusltmoyawzckiqteiqdgdeytyvcldpjqhhxjhgwlsoioqoiiozpxbctrsaluwhndymtlslvfglqpypmijfygwmosqxbgluxqifyxpreqmrnpiaeydbhoocmzhwctrrqsepnpzxptlcohaivqehhpylcubdrhmpmmwaetmywzyilgdrbnzbikshlpoypdxempyymxqkgjgcaygdspztwwqjonhccghihtrfmddljhlwatjxspplzfjjvavepvwvcjgwcaurloqrqenxbhonijsbplpojymxnjdskochgiaydwkadzjcdsecndrcxvvlgziohsfuiedvuwzkuzuppltzeqonbaslqzdnsonpjmhlttyzdoazqnbzcjrrabmuzyovmseqhsmjywvdwoxfyanrapwxypsholkspulseudtprojmwbgvvmnfnytgjisysitlqqipjendiwfdrjrcpfpdwzakhzlgssbdkmaerodenondzvsqdzehzpsfnozwnyerajabfxifpiirymxjkmxtqktejmjwtupwysjirybuuhojiwaiiprhmkaxbiweuhkwofkhhmstnuwyobqrbggjugkgfuicbnfqdrzxudetblgnticesupauqdctnlzwhsrytrxfaquhmmdfatqxriwbzllrpdltheswcaagirfkjsleitdghwrhubmfzgbpvkhcocajlcxwqrvewznvyhopnbxuweaokiloojvizzyaqmmxvyfmahvdovzqqcqtazkoexbpzfzzwstklysasnsyqvcerxfwvvfwkvbqbvhgmpvkegdnpkorclmomzbcpvrnemidgbbpzyipexqqmpozwnoiavosleftwqbwjjlgzzztjmgnuoepfigdruduzanoufmnvokaprtbgeihaewlguwifobkuqhxgicfrijzgwabbwxuxchjpdqknuzqxqleigdskawkrigpetbkhijazlymddhbhvxmzyakqlhylyhaqgygbnocpluzkkpadcrcrqxwwtmbcngucbnvtyopbbldipzndqqwzmgezuihgtljdiineqqxcrqwalhctawqlabphmjpldtnvvgxophjnxjrhwvbvecgaavfbdloqmlcbbltmjvugfphpmxujtpplrybqvqwyjtxvhdzqycbfnygfldzpgccqmvairepwivrzqfosurtglfnmjbssfeagcxatvlexzdjiaqcinfuffokezlyysbznacxlklwxwpvtleuwjfmyxatzrtuulktoegkboidqvxoeqzcjtosefcgqkdizvsfxxtvykrmvzucsllrpxvazxngqbigeqahmhjxiwmhauevonkbbgwbdwmkfuetqvpoxvewypdunbslpjziatvjrcylddqgxqdbcfsfeillcvwkncjnnrqzuyybisakiaqxgzsuatdfbdbbmewnprpcmhgzzikqtgcaiopruyuxllpanuwijqbpjjmzrhhfmyjmxgfaidvuntjpliabfxbxxucerokpcothlwmzfqoyyffhxfxrvfriczx";

        System.out.println("(fast with 'aba' )  must be true: " + new ValidPalindromeII().validPalindrome("aba"));
        System.out.println("(slow with 'aba' )  must be true: " + new ValidPalindromeII().validPalindromeSlow("aba"));
        System.out.println("(fast with 'tcaac' )  must be true: " + new ValidPalindromeII().validPalindrome("tcaac"));
        System.out.println("(slow with 'tcaac' )  must be true: " + new ValidPalindromeII().validPalindromeSlow("tcaac"));
        System.out.println("(fast with 'abca')  must be true: " + new ValidPalindromeII().validPalindrome("abca"));
        System.out.println("(slow with 'abca')  must be true: " + new ValidPalindromeII().validPalindromeSlow("abca"));
        System.out.println("(fast with 'abc' )  must be false: " + new ValidPalindromeII().validPalindrome("abc"));
        System.out.println("(slow with 'abc ')  must be false: " + new ValidPalindromeII().validPalindromeSlow("abc"));
        System.out.println("(fast with 'dedeeee')  must be false: " + new ValidPalindromeII().validPalindrome("dedeeee"));
        System.out.println("(slow with 'dedeeee')  must be false: " + new ValidPalindromeII().validPalindromeSlow("dedeeee"));
        System.out.println("(fast with 'deeee') must be true: " + new ValidPalindromeII().validPalindrome("deeee"));
        System.out.println("(slow with 'deeee') must be true: " + new ValidPalindromeII().validPalindromeSlow("deeee"));
        System.out.println("(fast with 'angna') must be true: " + new ValidPalindromeII().validPalindrome("angna"));
        System.out.println("(slow with 'angna') must be true: " + new ValidPalindromeII().validPalindromeSlow("angna"));
        System.out.println("(fast with 'a')     must be true: " + new ValidPalindromeII().validPalindrome("a"));
        System.out.println("(slow with 'a')     must be true: " + new ValidPalindromeII().validPalindromeSlow("a"));
        System.out.println("(fast with '')      must be true: " + new ValidPalindromeII().validPalindrome(""));
        System.out.println("(slow with '')      must be true: " + new ValidPalindromeII().validPalindromeSlow(""));
        System.out.println("(fast with 'eeccccbebaeeabebccceea')      must be false: " + new ValidPalindromeII().validPalindrome("eeccccbebaeeabebccceea"));
        System.out.println("(slow with 'eeccccbebaeeabebccceea')      must be false: " + new ValidPalindromeII().validPalindromeSlow("eeccccbebaeeabebccceea"));
        System.out.println("(fast with longest) must be true: " + new ValidPalindromeII().validPalindrome(longest));
        System.out.println("(slow with longest) must be true: " + new ValidPalindromeII().validPalindromeSlow(longest));
    }


    public boolean validPalindrome(String s) {
        int firstIndex, lastIndex;
        int missingLetters = 0; // Palindrome anomaly score.

        // check string
        for (firstIndex = 0, lastIndex = s.length() - 1; firstIndex <= lastIndex; firstIndex++, lastIndex--) {
            char skippedFirst = s.charAt(firstIndex);
            char skippedLast = s.charAt(lastIndex);

            // if anomaly found
            if (skippedFirst != skippedLast) {
                missingLetters++;

                //try check two pairs without current letter
                boolean firstPair = s.charAt(firstIndex) == s.charAt(lastIndex - 1);
                boolean secondPair = s.charAt(firstIndex + 1) == s.charAt(lastIndex);
                if (firstPair | secondPair) continue; // at least one pair works. Its palindrome without one letter.
                else return false; // if both pairs wrong it is not palindrome.
            }
        }

        return missingLetters < 2;
    }


    public boolean validPalindromeSlow(String s) {

        // First check palindrome.
        StringBuilder builder = new StringBuilder(s);
        if (builder.reverse().toString().equals(s)) return true;

        // Try to delete letters and check possible palindrome.
        for (int i = 0; i < s.length(); i++) {
            char ch = builder.charAt(i);
            builder.deleteCharAt(i); // Delete one char.
            if (new StringBuilder(builder).reverse().toString().equals(builder.toString())) return true; // Check it.
            builder.insert(i, ch); // Return this char back.
        }
        return false;
    }

}
